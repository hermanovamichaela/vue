<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Quiz</title>

    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
  </head>

  <body>
    <div id="app">
      {{ message }}
      <div v-if="display">
        <button @click="start">Start</button>
        <button @click="end">Konec</button>
      </div>
      <div v-if="visible">
        <div v-for="(question, index) in questions">
          <div v-if="index === current_question">
            {{ question.question }}
            <select v-model="question.user_answer">
              <option></option>
              <option
                v-for="answer in question.answers"
                class="question_one_option"
              >
                {{ answer }}
              </option>
            </select>
          </div>
        </div>

        <button
          v-if="current_question < questions.length - 1"
          @click="next"
          :disabled="!questions[current_question].user_answer"
        >
          Next
        </button>
        <button
          v-if="current_question === questions.length - 1"
          @click="checkAnswers"
        >
          Vyhodnotit
        </button>
        <button @click="reset">Reset</button>
      </div>
      <div v-if="results">
        <span>Špatné odpovědi: {{ wrong_answers.length }}</span>
        <span
          >Správné odpovědi: {{ questions.length - wrong_answers.length }}</span
        >
        <span>Tvá úspěšnost: {{ percentil }}%</span>
      </div>
    </div>

    <script>
      const vm = new Vue({
        el: '#app',
        data: {
          message: 'Vítej v dnešním kvízu! Můžeme začít?',
          questions: [
            {
              question: 'Která herní konzole byla vytvořena dříve?',
              answers: ['PS', 'XBox'],
              correct_answer: 'PS',
              user_answer: '',
            },
            {
              question: 'Jak se jmenoval plešatý strýček z Addams Family?',
              answers: ['Tester', 'Fester'],
              correct_answer: 'Fester',
              user_answer: '',
            },
            {
              question: 'Kolik dílů mají Avengers?',
              answers: ['5', '4'],
              correct_answer: '4',
              your_answer: '',
            },
            {
              question: 'Ošemetná otázka... Marvel nebo DC?',
              answers: ['Dycky DC!', 'Dycky Marvel!'],
              correct_answer: 'Dycky Marvel!',
              your_answer: '',
            },
          ],
          current_question: 0,
          display: true,
          visible: false,
          results: false,
          wrong_answers: [],
          percentil: 100,
        },
        methods: {
          start() {
            this.message = 'Jdeme na to!';
            this.visible = true;
            this.display = false;
            this.check_button = true;
            this.reset_button = true;
          },
          end() {
            this.message = 'Měj se hezky :)';
            this.visible = false;
            this.display = false;
          },
          next() {
            this.current_question++;
          },
          reset() {
            this.current_question = 0;
            this.wrong_answers = [];
          },
          checkAnswers() {
            //PŘIDÁNÍ ODPOVĚDÍ DO POLE A DELETE STÁVAJÍCÍHO OBSAHU
            this.visible = false;
            this.results = true;
            this.message = '';

            const wrongAnswers = [];
            const count = this.questions.length;

            for (let i = 0; i < count; i++) {
              if (
                this.questions[i].user_answer !==
                this.questions[i].correct_answer
              ) {
                wrongAnswers.push(this.questions[i]);
              }
            }

            this.wrong_answers = wrongAnswers;
            this.percentil =
              ((this.questions.length - this.wrong_answers.length) /
                this.questions.length) *
              100;
            if (wrongAnswers.length === 0) {
              console.log('Vše správně');
            } else if (wrongAnswers.length !== count) {
              console.log('Něco je špatne');
            } else {
              console.log('Jsi looser!');
            }
          },
        },
      });
    </script>
  </body>
</html>
